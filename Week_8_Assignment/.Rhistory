getwd("..")
getwd()
library(readxl)
library(purrr)
library(dplyr)
housing_df <- read_excel("week-6-housing.xlsx")
transformed_housing_df <- housing_df %>%
select(`Sale Date`,`Sale Price`,building_grade:year_built, sq_ft_lot)
new_housing_df <- transformed_housing_df[sample(1:nrow(transformed_housing_df)), ]
linearReg_salePrice <- lm(`Sale Price` ~ sq_ft_lot, data = new_housing_df)
multiReg_salePrice <- lm(`Sale Price` ~ sq_ft_lot + square_feet_total_living +
building_grade + year_built, data = new_housing_df)
library(readxl)
library(purrr)
library(dplyr)
housing_df <- read_excel("week-6-housing.xlsx")
transformed_housing_df <- housing_df %>%
select(`Sale Date`,`Sale Price`,building_grade:year_built, sq_ft_lot)
new_housing_df <- transformed_housing_df[sample(1:nrow(transformed_housing_df)), ]
linearReg_salePrice <- lm(`Sale Price` ~ sq_ft_lot, data = new_housing_df)
multiReg_salePrice <- lm(`Sale Price` ~ sq_ft_lot + square_feet_total_living +
building_grade + year_built, data = new_housing_df)
summary(linearReg_salePrice)
summary(multiReg_salePrice)
library(lm.beta)
lm.beta(linearReg_salePrice)
lm.beta(multiReg_salePrice)
confint(linearReg_salePrice)
confint(multiReg_salePrice)
options(scipen=999)
anova(linearReg_salePrice, multiReg_salePrice)
new_housing_df$residuals <- resid(multiReg_salePrice)
new_housing_df$standardized.residuals <- rstandard(multiReg_salePrice)
new_housing_df$studentized.residuals <- rstudent(multiReg_salePrice)
new_housing_df$cooks.dist <- cooks.distance(multiReg_salePrice)
new_housing_df$dfbeta <- dfbeta(multiReg_salePrice)
new_housing_df$dffit <- dffits(multiReg_salePrice)
new_housing_df$leverage <- hatvalues(multiReg_salePrice)
new_housing_df$covariance.ratios <- covratio(multiReg_salePrice)
new_housing_df$large.residual <- new_housing_df$standardized.residuals > 2 | new_housing_df$standardized.residuals < -2
sum(new_housing_df$large.residual)
true_cases_housing <- new_housing_df[new_housing_df$large.residual, c('Sale Price', "sq_ft_lot", "square_feet_total_living", "building_grade", "year_built", "standardized.residuals")]
cook_distance_df <- new_housing_df[new_housing_df$large.residual, c("cooks.dist", "leverage", "covariance.ratios")]
sum(cook_distance_df$covariance.ratios < 0.97 & (cook_distance_df$leverage > 0.001166 | cook_distance_df$leverage < 0.000387))
library(car)
durbinWatsonTest(multiReg_salePrice)
vif(multiReg_salePrice)
1/vif(multiReg_salePrice)
mean(vif(multiReg_salePrice))
plot(multiReg_salePrice, pch= 20, cex = 0.2)
hist(new_housing_df$studentized.residuals, binwidth= 0.5, bins= 10)
library(readxl)
library(purrr)
library(dplyr)
housing_df <- read_excel("week-6-housing.xlsx")
transformed_housing_df <- housing_df %>%
select(`Sale Date`,`Sale Price`,building_grade:year_built, sq_ft_lot)
new_housing_df <- transformed_housing_df[sample(1:nrow(transformed_housing_df)), ]
linearReg_salePrice <- lm(`Sale Price` ~ sq_ft_lot, data = new_housing_df)
multiReg_salePrice <- lm(`Sale Price` ~ sq_ft_lot + square_feet_total_living +
building_grade + year_built, data = new_housing_df)
summary(linearReg_salePrice)
summary(multiReg_salePrice)
library(lm.beta)
lm.beta(linearReg_salePrice)
lm.beta(multiReg_salePrice)
confint(linearReg_salePrice)
confint(multiReg_salePrice)
options(scipen=999)
anova(linearReg_salePrice, multiReg_salePrice)
new_housing_df$residuals <- resid(multiReg_salePrice)
new_housing_df$standardized.residuals <- rstandard(multiReg_salePrice)
new_housing_df$studentized.residuals <- rstudent(multiReg_salePrice)
new_housing_df$cooks.dist <- cooks.distance(multiReg_salePrice)
new_housing_df$dfbeta <- dfbeta(multiReg_salePrice)
new_housing_df$dffit <- dffits(multiReg_salePrice)
new_housing_df$leverage <- hatvalues(multiReg_salePrice)
new_housing_df$covariance.ratios <- covratio(multiReg_salePrice)
new_housing_df$large.residual <- new_housing_df$standardized.residuals > 2 | new_housing_df$standardized.residuals < -2
sum(new_housing_df$large.residual)
true_cases_housing <- new_housing_df[new_housing_df$large.residual, c('Sale Price', "sq_ft_lot", "square_feet_total_living", "building_grade", "year_built", "standardized.residuals")]
cook_distance_df <- new_housing_df[new_housing_df$large.residual, c("cooks.dist", "leverage", "covariance.ratios")]
sum(cook_distance_df$covariance.ratios < 0.97 & (cook_distance_df$leverage > 0.001166 | cook_distance_df$leverage < 0.000387))
library(car)
durbinWatsonTest(multiReg_salePrice)
vif(multiReg_salePrice)
1/vif(multiReg_salePrice)
mean(vif(multiReg_salePrice))
plot(multiReg_salePrice, pch= 20, cex = 0.2)
hist(new_housing_df$studentized.residuals, binwidth= 0.5, bins= 10)
